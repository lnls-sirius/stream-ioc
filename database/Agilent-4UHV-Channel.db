# Agilent-4UHV-Channel.db

# Record definition file for one Agilent 4UHV Ion Pump Controller channel. This is based on the work
# of Pete Owens from the Science and Technology Facilities Council (STFC).

# Parameters are:
#
# CHANNEL_NUMBER - Controller channel (from 1 to 4).
#
# PORT - Name of the serial port configured in asynDriver.
#
# PREFIX - Prefix name for all PVs associated with the channel.
#
# SERIAL_ADDRESS - Controller RS-485 serial address (from 0 to 31). For configuring this parameter,
# add 128 to the desired address. As an example, for the serial address 20, this parameter should
# be configured as 128 + 20 = 148.

# Current

record(ai, "$(PREFIX):Current-Mon") {
    field(DESC, "Measured current")
    field(DTYP, "stream")
    field(EGU, "A")
    field(HOPR, "0.9")
    field(INP, "@Agilent-4UHV.proto getCurrent($(SERIAL_ADDRESS),$(CHANNEL_NUMBER)) $(PORT)")
    field(LOPR, "0")
    field(PINI, "YES")
    field(PREC, "10")
    field(SCAN, "10 second")
}

# HV temperature

record(longin, "$(PREFIX):HVTemperature-Mon") {
    field(DESC, "HV temperature")
    field(DTYP, "stream")
    field(EGU, "degrees Celsius")
    field(HOPR, "200")
    field(INP, "@Agilent-4UHV.proto getHVTemperature$(CHANNEL_NUMBER)($(SERIAL_ADDRESS)) $(PORT)")
    field(LOPR, "0")
    field(PINI, "YES")
    field(SCAN, "10 second")
}

# Pressure

record(ai, "$(PREFIX):Pressure-Mon") {
    field(DESC, "Measured pressure")
    field(DTYP, "stream")
    field(EGU, "mbar")
    field(INP, "@Agilent-4UHV.proto getPressure($(SERIAL_ADDRESS),$(CHANNEL_NUMBER)) $(PORT)")
    field(PINI, "YES")
    field(PREC, "9")
    field(SCAN, "2 second")
}

# Voltage

record(ai, "$(PREFIX):Voltage-Mon") {
    field(DESC, "Measured voltage")
    field(DTYP, "stream")
    field(EGU, "kV")
    field(ESLO, "0.001")
    field(HOPR, "10")
    field(INP, "@Agilent-4UHV.proto getVoltage($(SERIAL_ADDRESS),$(CHANNEL_NUMBER)) $(PORT)")
    field(LINR, "LINEAR")
    field(LOPR, "0")
    field(PINI, "YES")
    field(PREC, "1")
    field(SCAN, "10 second")
}
